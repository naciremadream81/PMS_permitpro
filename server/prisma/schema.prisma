datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id           Int      @id @default(autoincrement())
  email        String   @unique
  passwordHash String
  role         Role     @default(User)
  createdAt    DateTime @default(now())
}

enum Role {
  Admin
  User
}

model Customer {
  id             Int             @id @default(autoincrement())
  name           String
  email          String?
  phone          String?
  address        String?
  permitPackages PermitPackage[]
}

model Contractor {
  id             Int             @id @default(autoincrement())
  companyName    String
  licenseNumber  String          @unique
  contactPerson  String?
  email          String?
  phone          String?
  permitPackages PermitPackage[]
}

model PermitPackage {
  id           Int           @id @default(autoincrement())
  county       String
  status       String        @default("Draft")
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  customer     Customer      @relation(fields: [customerId], references: [id])
  customerId   Int
  contractor   Contractor    @relation(fields: [contractorId], references: [id])
  contractorId Int
  documents    Document[]
}

model Document {
  id              Int           @id @default(autoincrement())
  fileName        String
  filePath        String
  documentType    String // 'Template', 'FilledForm', 'Attachment'
  uploadedAt      DateTime      @default(now())
  permitPackage   PermitPackage @relation(fields: [permitPackageId], references: [id])
  permitPackageId Int
}
